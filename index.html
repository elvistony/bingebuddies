
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BingeBud | Serverless Watch Together | Elvis Tony</title>
    <meta name="description" content="A Serverless Watch Together Solution built on a Peer to Peer Network">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css">   

</head>
<body>
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 text-center">   

                <h1>BingeBud</h1>
                <button class="button btn btn-primary" id="create-room">Create New Theatre</button>
                
                <div class="mt-4" id="linkSection" style="display: none;">
                  <div class="form-group mb-2">
                    <input class="form-control mt-2" type="text" name="" readonly placeholder="Click the button to create a new Room" id="link-url">
                  </div>
                  <a target="_blank" class="btn button btn-warning" id="link-admin" href="#">Open Admin Panel</a>
                  <a  target="_blank"  class="btn button btn-success" id="link-theatre" href="#">Open Theatre</a>
                  <button class="btn btn-info button" is="google-cast-button">Cast</button>
                </div>
                
            </div>
        </div>
    </div>
    <script>
      var createBtn = document.getElementById('create-room');
      const baseURL = 'https://elvistony.dev/bingebuddies/'
      createBtn.addEventListener('click',()=>{
        var roomId = Math.random().toString(36).slice(2);
        document.getElementById('linkSection').style.display='block';
        document.getElementById('link-url').value = roomId;
    
        document.getElementById('link-theatre').setAttribute('href',baseURL+"play/#/"+roomId);
        document.getElementById('link-admin').setAttribute('href',baseURL+"admin/#/"+roomId);
      })
    </script>
    <script>
      window.__onGCastApiAvailable = function(isAvailable) {
          if (!isAvailable) {
              return false;
          }
      
          var castContext = cast.framework.CastContext.getInstance();
      
          castContext.setOptions({
              autoJoinPolicy: chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,
              receiverApplicationId: chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID
          });
      
          var stateChanged = cast.framework.CastContextEventType.CAST_STATE_CHANGED;
          castContext.addEventListener(stateChanged, function(event) {
              var castSession = castContext.getCurrentSession();
              
              // Create a media info object with a webpage URL
              var media = new chrome.cast.media.MediaInfo(document.location, 'text/html');
              
              var request = new chrome.cast.media.LoadRequest(media);
      
              castSession && castSession
                  .loadMedia(request)
                  .then(function() {
                      console.log('Success');
                  })
                  .catch(function(error) {
                      console.log('Error: ' + error);
                  });
          });
      };
      
      </script>
      <script src='https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1'></script>
</body>
</html>